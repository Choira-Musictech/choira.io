{"ast":null,"code":"var _jsxFileName = \"E:\\\\ui\\\\src\\\\pages\\\\externalExplore\\\\Waveform.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState } from \"react\";\nimport WaveSurfer from \"wavesurfer.js\";\nimport iconBox from \"../../assets/explore/playButton.png\";\nimport iconPauseBox from \"../../assets/explore/pause.png\";\nimport trackImage from \"../../assets/explore/trackImage.png\";\nimport { docServerUrl } from '../../restservice';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst formWaveSurferOptions = ref => ({\n  container: ref,\n  waveColor: \"#4e4e50\",\n  progressColor: \"#3e3e40\",\n  cursorColor: \"#4e4e50\",\n  barWidth: 2,\n  barRadius: 1,\n  responsive: true,\n  height: 20,\n  // If true, normalize by the maximum peak instead of 1.0.\n  normalize: true,\n  // Use the PeakCache to improve rendering speed of large waveforms.\n  partialRender: true,\n  xhr: {\n    cache: \"default\",\n    mode: \"cors\",\n    method: \"GET\",\n    credentials: \"include\",\n    headers: [{\n      key: \"cache-control\",\n      value: \"no-cache\"\n    }, {\n      key: \"pragma\",\n      value: \"no-cache\"\n    }]\n  },\n  xhr1: {\n    cache: 'default',\n    mode: 'cors',\n    method: 'GET',\n    credentials: 'same-origin',\n    redirect: 'follow',\n    referrer: 'client',\n    headers: [{\n      key: 'Authorization',\n      value: 'my-token'\n    }]\n  }\n});\nlet oldtrackid = null;\nlet oldplayingAudio = null;\nexport default function Waveform({\n  url,\n  url1,\n  tracks,\n  id,\n  setSelectedPlayButton,\n  selectedPlayButton\n}) {\n  _s();\n  const waveformRef = useRef(null);\n  var wavesurfer = [];\n  const [waveform, setWaveform] = useState(null);\n  const [playing, setPlay] = useState(false);\n  const [audioContext, setAudioContext] = useState(new AudioContext());\n  const docServer = docServerUrl;\n\n  // create new WaveSurfer instance\n  // On component mount and when url changes\n  useEffect(() => {\n    setPlay(false);\n    if (waveformRef.current) {\n      wavesurfer[id] = WaveSurfer.create({\n        // audioContext: audioContext,\n        container: waveformRef.current,\n        waveColor: \"#4e4e50\",\n        progressColor: \"#fcc12e\",\n        cursorColor: \"#4e4e50\",\n        barWidth: 0,\n        barRadius: 1,\n        responsive: true,\n        hideScrollbar: true,\n        height: 20,\n        // normalize: true,\n        partialRender: true,\n        pixelRatio: window.devicePixelRatio = 1\n      });\n      wavesurfer[id].on('finish', handlePlayPause);\n      wavesurfer[id].load(url);\n      setWaveform(wavesurfer[id]);\n    }\n    return () => wavesurfer[id].destroy();\n  }, [url]);\n  const handlePlayPause = () => {\n    if (oldtrackid === null) {\n      waveform.play();\n      setPlay(true);\n    } else if (oldtrackid !== waveform) {\n      if (oldtrackid.backend !== null) {\n        oldtrackid.stop();\n      }\n      waveform.play();\n      setPlay(true);\n    } else if (oldtrackid === waveform) {\n      oldtrackid.stop();\n      setPlay(false);\n      if (playing) {\n        setPlay(false);\n      } else {\n        waveform.play();\n        setPlay(true);\n      }\n    } else {\n      waveform.play();\n    }\n    oldtrackid = waveform;\n    setSelectedPlayButton(tracks.name);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"songTracks\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"controls\",\n      children: [url1 ? /*#__PURE__*/_jsxDEV(\"img\", {\n        src: url1,\n        alt: \"trackI1mg\",\n        width: \"57px\",\n        className: \"trackImg\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 21\n      }, this) : /*#__PURE__*/_jsxDEV(\"img\", {\n        src: trackImage,\n        alt: \"trackImg\",\n        width: \"57px\",\n        className: \"trackImg\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        onClick: handlePlayPause,\n        className: \"play\",\n        children: selectedPlayButton == tracks.name && playing ? /*#__PURE__*/_jsxDEV(\"img\", {\n          src: iconPauseBox,\n          alt: \"icon\",\n          className: \"upImage\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 21\n        }, this) : /*#__PURE__*/_jsxDEV(\"img\", {\n          src: iconBox,\n          alt: \"icon\",\n          className: \"upImage\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"trackDetail\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"trackName\",\n        children: tracks.name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"trackComposer\",\n        children: [tracks.composer, \",\", tracks.genre]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"waveform\",\n      ref: waveformRef,\n      style: {\n        zIndex: '1'\n      },\n      className: \"wavehiden\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 97,\n    columnNumber: 9\n  }, this);\n}\n_s(Waveform, \"WPJw4uRxaWAXr2BPnAUCbNezoXk=\");\n_c = Waveform;\nvar _c;\n$RefreshReg$(_c, \"Waveform\");","map":{"version":3,"names":["React","useEffect","useRef","useState","WaveSurfer","iconBox","iconPauseBox","trackImage","docServerUrl","jsxDEV","_jsxDEV","formWaveSurferOptions","ref","container","waveColor","progressColor","cursorColor","barWidth","barRadius","responsive","height","normalize","partialRender","xhr","cache","mode","method","credentials","headers","key","value","xhr1","redirect","referrer","oldtrackid","oldplayingAudio","Waveform","url","url1","tracks","id","setSelectedPlayButton","selectedPlayButton","_s","waveformRef","wavesurfer","waveform","setWaveform","playing","setPlay","audioContext","setAudioContext","AudioContext","docServer","current","create","hideScrollbar","pixelRatio","window","devicePixelRatio","on","handlePlayPause","load","destroy","play","backend","stop","name","className","children","src","alt","width","fileName","_jsxFileName","lineNumber","columnNumber","onClick","composer","genre","style","zIndex","_c","$RefreshReg$"],"sources":["E:/ui/src/pages/externalExplore/Waveform.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\n\nimport WaveSurfer from \"wavesurfer.js\";\nimport iconBox from \"../../assets/explore/playButton.png\"\nimport iconPauseBox from \"../../assets/explore/pause.png\"\nimport trackImage from \"../../assets/explore/trackImage.png\"\nimport { docServerUrl } from '../../restservice';\n\nconst formWaveSurferOptions = ref => ({\n    container: ref,\n    waveColor: \"#4e4e50\",\n    progressColor: \"#3e3e40\",\n    cursorColor: \"#4e4e50\",\n    barWidth: 2,\n    barRadius: 1,\n    responsive: true,\n    height: 20,\n    // If true, normalize by the maximum peak instead of 1.0.\n    normalize: true,\n    // Use the PeakCache to improve rendering speed of large waveforms.\n    partialRender: true,\n    xhr: { cache: \"default\", mode: \"cors\", method: \"GET\", credentials: \"include\", headers: [{ key: \"cache-control\", value: \"no-cache\" }, { key: \"pragma\", value: \"no-cache\" }] },\n    xhr1 : { cache: 'default', mode: 'cors', method: 'GET', credentials: 'same-origin', redirect: 'follow', referrer: 'client', headers: [{ key: 'Authorization', value: 'my-token' }] }\n});\n\nlet oldtrackid = null;\nlet oldplayingAudio = null;\n\nexport default function Waveform({ url, url1, tracks, id, setSelectedPlayButton, selectedPlayButton }) {\n    const waveformRef = useRef(null);\n    var wavesurfer = [];\n    const [waveform, setWaveform] = useState(null)\n    const [playing, setPlay] = useState(false);\n    const [audioContext, setAudioContext] = useState(new AudioContext())\n\n    const docServer = docServerUrl\n\n    // create new WaveSurfer instance\n    // On component mount and when url changes\n    useEffect(() => {\n        setPlay(false);\n        if (waveformRef.current) {\n            wavesurfer[id] = WaveSurfer.create({\n                // audioContext: audioContext,\n                container: waveformRef.current,\n                waveColor: \"#4e4e50\",\n                progressColor: \"#fcc12e\",\n                cursorColor: \"#4e4e50\",\n                barWidth: 0,\n                barRadius: 1,\n                responsive: true,\n                hideScrollbar: true,\n                height: 20,\n                // normalize: true,\n                partialRender: true,\n                pixelRatio: window.devicePixelRatio = 1,\n\n            });\n\n            wavesurfer[id].on('finish', handlePlayPause)\n            wavesurfer[id].load(url)\n            setWaveform(wavesurfer[id])\n        }\n\n        return () => wavesurfer[id].destroy();\n    }, [url]);\n\n    const handlePlayPause = () => {\n\n        if (oldtrackid === null) {\n            waveform.play();\n            setPlay(true);\n        } else if (oldtrackid !== waveform) {\n            if (oldtrackid.backend !== null) {\n                oldtrackid.stop();\n            }\n            waveform.play();\n            setPlay(true);\n        } else if (oldtrackid === waveform) {\n            oldtrackid.stop();\n            setPlay(false);\n            if (playing) {\n                setPlay(false);\n            } else {\n                waveform.play();\n                setPlay(true);\n            }\n        } else {\n            waveform.play();\n        }\n\n        oldtrackid = waveform;\n        setSelectedPlayButton(tracks.name)\n    };\n\n    return (\n        <div className=\"songTracks\">\n\n            <div className=\"controls\">\n                {url1 ?\n                    <img src={url1} alt=\"trackI1mg\" width=\"57px\" className=\"trackImg\" />\n                    :\n                    <img src={trackImage} alt=\"trackImg\" width=\"57px\" className=\"trackImg\" />\n                }\n                {/* <button onClick={handlePlayPause}>{!playing ? \"Play\" : \"Pause\"}</button>                 */}\n\n                <div onClick={handlePlayPause} className=\"play\">{selectedPlayButton == tracks.name && playing ?\n                    <img src={iconPauseBox} alt=\"icon\" className='upImage' />\n                    :\n                    <img src={iconBox} alt=\"icon\" className='upImage' />\n                }</div>\n            </div>\n            <div className=\"trackDetail\" >\n                <div className=\"trackName\">{tracks.name}</div>\n                <div className=\"trackComposer\">{tracks.composer},{tracks.genre}</div>\n            </div>\n            <div id=\"waveform\" ref={waveformRef} style={{ zIndex: '1' }} className=\"wavehiden\" />\n        </div>\n\n    );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}